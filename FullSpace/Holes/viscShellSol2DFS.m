
function [ur,ut,Srr,Stt,Szz,Err,Ett,Ezz]=viscShellSol2DFS(R1,R2,eta,mu,t,rIn,p,nu)
% if nu~=0.25
%     error('Only derived for 0.25')
% end
%Fullspace. 
%tr=eta/mu*(R2^2/R1^2);
E=(2*mu)*(1+nu);
K=((2*mu)*(1+nu))/(3*(1-(2*nu)));
mu2=mu;
InShell=rIn>R1 & rIn<R2;
ur=zeros(size(rIn));
ut=zeros(size(rIn));
Srr=zeros(size(rIn));
Stt=zeros(size(rIn));
Szz=zeros(size(rIn));
Err=zeros(size(rIn));
Ett=zeros(size(rIn));
Ezz=zeros(size(rIn));
for i=1:numel(rIn)
    r=rIn(i);
        
    q1=(2*eta);
    p1=(2*eta)/(2*mu);
    

    if InShell(i)==1  
       

        %C:\Users\eart0546\Documents\GitHub\MAST_strain_compuations\ViscoelasticDerivation2D_Try4.m
        %2nd part "%% Using viscoelastic book derivation Eq.8.40a-c"
        %UseEsub==1
        ur(i) =(p*(K*R2^2 + R2^2*mu - mu*r^2))/(2*K*mu*r) + (p*q1*exp(-(t*(3*K*R2^2*q1 - 3*K*R1^2*q1 + R1^2*mu*q1 + 3*R2^2*mu*q1 + 12*K*R1^2*mu*p1))/(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2))*(cosh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1))) + (sinh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1)))*((6*K^2*R1^2*R2^2 - 6*K^2*R2^4 + 6*K*R1^2*R2^2*mu - 12*K*R2^4*mu + 6*K*R2^2*mu*r^2 - 2*R1^2*R2^2*mu^2 + 2*R1^2*mu^2*r^2 - 6*R2^4*mu^2 + 6*R2^2*mu^2*r^2)/(6*p1*K^2*R1^2*R2^2 - 6*p1*K^2*R2^4 + 6*p1*K*R1^2*R2^2*mu + q1*K*R1^2*R2^2 - 12*p1*K*R2^4*mu - q1*K*R2^4 + 6*p1*K*R2^2*mu*r^2 - 2*p1*R1^2*R2^2*mu^2 + q1*R1^2*R2^2*mu + 2*p1*R1^2*mu^2*r^2 - q1*R1^2*mu*r^2 - 6*p1*R2^4*mu^2 - q1*R2^4*mu + 6*p1*R2^2*mu^2*r^2 + q1*R2^2*mu*r^2) - (3*K*R2^2*q1 - 3*K*R1^2*q1 + R1^2*mu*q1 + 3*R2^2*mu*q1 + 12*K*R1^2*mu*p1)/(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2))*(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2))/(q1*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2)))*(6*p1*K^2*R1^2*R2^2 - 6*p1*K^2*R2^4 + 6*p1*K*R1^2*R2^2*mu + q1*K*R1^2*R2^2 - 12*p1*K*R2^4*mu - q1*K*R2^4 + 6*p1*K*R2^2*mu*r^2 - 2*p1*R1^2*R2^2*mu^2 + q1*R1^2*R2^2*mu + 2*p1*R1^2*mu^2*r^2 - q1*R1^2*mu*r^2 - 6*p1*R2^4*mu^2 - q1*R2^4*mu + 6*p1*R2^2*mu^2*r^2 + q1*R2^2*mu*r^2))/(2*K*mu*r*(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2));
        Srr(i) =- p - (R2^2*p*q1*exp(-(t*(3*K*R2^2*q1 - 3*K*R1^2*q1 + R1^2*mu*q1 + 3*R2^2*mu*q1 + 12*K*R1^2*mu*p1))/(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2))*(R1^2 - r^2)*(cosh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1))) + (sinh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1)))*(- 18*p1*K^2*R1^2 + 18*p1*K^2*R2^2 - 24*p1*K*R1^2*mu - 3*q1*K*R1^2 + 36*p1*K*R2^2*mu + 3*q1*K*R2^2 + 6*p1*R1^2*mu^2 - 7*q1*R1^2*mu + 18*p1*R2^2*mu^2 + 3*q1*R2^2*mu))/((q1 + 6*K*p1 + 6*mu*p1)*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2)))*(q1 + 6*K*p1 + 6*mu*p1))/(r^2*(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2));
        Stt(i) =((R2^2*p*q1*exp(-(t*(3*K*R2^2*q1 - 3*K*R1^2*q1 + R1^2*mu*q1 + 3*R2^2*mu*q1 + 12*K*R1^2*mu*p1))/(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2))*(cosh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1))) + (sinh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1)))*(- 18*p1*K^2*R1^2 + 18*p1*K^2*R2^2 - 24*p1*K*R1^2*mu - 3*q1*K*R1^2 + 36*p1*K*R2^2*mu + 3*q1*K*R2^2 + 6*p1*R1^2*mu^2 - 7*q1*R1^2*mu + 18*p1*R2^2*mu^2 + 3*q1*R2^2*mu))/((q1 + 6*K*p1 + 6*mu*p1)*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2)))*(R1^2 + r^2)*(q1 + 6*K*p1 + 6*mu*p1))/(r^2*(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2)) - p);
        
        Err(i) =(p*q1*exp(-(t*(3*K*R2^2*q1 - 3*K*R1^2*q1 + R1^2*mu*q1 + 3*R2^2*mu*q1 + 12*K*R1^2*mu*p1))/(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2))*(cosh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1))) + (sinh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1)))*((- 6*K^2*R1^2*R2^2 + 6*K^2*R2^4 - 6*K*R1^2*R2^2*mu + 12*K*R2^4*mu + 6*K*R2^2*mu*r^2 + 2*R1^2*R2^2*mu^2 + 2*R1^2*mu^2*r^2 + 6*R2^4*mu^2 + 6*R2^2*mu^2*r^2)/(- 6*p1*K^2*R1^2*R2^2 + 6*p1*K^2*R2^4 - 6*p1*K*R1^2*R2^2*mu - q1*K*R1^2*R2^2 + 12*p1*K*R2^4*mu + q1*K*R2^4 + 6*p1*K*R2^2*mu*r^2 + 2*p1*R1^2*R2^2*mu^2 - q1*R1^2*R2^2*mu + 2*p1*R1^2*mu^2*r^2 - q1*R1^2*mu*r^2 + 6*p1*R2^4*mu^2 + q1*R2^4*mu + 6*p1*R2^2*mu^2*r^2 + q1*R2^2*mu*r^2) - (3*K*R2^2*q1 - 3*K*R1^2*q1 + R1^2*mu*q1 + 3*R2^2*mu*q1 + 12*K*R1^2*mu*p1)/(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2))*(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2))/(q1*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2)))*(- 6*p1*K^2*R1^2*R2^2 + 6*p1*K^2*R2^4 - 6*p1*K*R1^2*R2^2*mu - q1*K*R1^2*R2^2 + 12*p1*K*R2^4*mu + q1*K*R2^4 + 6*p1*K*R2^2*mu*r^2 + 2*p1*R1^2*R2^2*mu^2 - q1*R1^2*R2^2*mu + 2*p1*R1^2*mu^2*r^2 - q1*R1^2*mu*r^2 + 6*p1*R2^4*mu^2 + q1*R2^4*mu + 6*p1*R2^2*mu^2*r^2 + q1*R2^2*mu*r^2))/(2*K*mu*r^2*(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2)) - (p*(K*R2^2 + R2^2*mu + mu*r^2))/(2*K*mu*r^2);
        Ett(i) =(p*(K*R2^2 + R2^2*mu - mu*r^2))/(2*K*mu*r^2) + (p*q1*exp(-(t*(3*K*R2^2*q1 - 3*K*R1^2*q1 + R1^2*mu*q1 + 3*R2^2*mu*q1 + 12*K*R1^2*mu*p1))/(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2))*(cosh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1))) + (sinh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1)))*((6*K^2*R1^2*R2^2 - 6*K^2*R2^4 + 6*K*R1^2*R2^2*mu - 12*K*R2^4*mu + 6*K*R2^2*mu*r^2 - 2*R1^2*R2^2*mu^2 + 2*R1^2*mu^2*r^2 - 6*R2^4*mu^2 + 6*R2^2*mu^2*r^2)/(6*p1*K^2*R1^2*R2^2 - 6*p1*K^2*R2^4 + 6*p1*K*R1^2*R2^2*mu + q1*K*R1^2*R2^2 - 12*p1*K*R2^4*mu - q1*K*R2^4 + 6*p1*K*R2^2*mu*r^2 - 2*p1*R1^2*R2^2*mu^2 + q1*R1^2*R2^2*mu + 2*p1*R1^2*mu^2*r^2 - q1*R1^2*mu*r^2 - 6*p1*R2^4*mu^2 - q1*R2^4*mu + 6*p1*R2^2*mu^2*r^2 + q1*R2^2*mu*r^2) - (3*K*R2^2*q1 - 3*K*R1^2*q1 + R1^2*mu*q1 + 3*R2^2*mu*q1 + 12*K*R1^2*mu*p1)/(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2))*(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2))/(q1*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2)))*(6*p1*K^2*R1^2*R2^2 - 6*p1*K^2*R2^4 + 6*p1*K*R1^2*R2^2*mu + q1*K*R1^2*R2^2 - 12*p1*K*R2^4*mu - q1*K*R2^4 + 6*p1*K*R2^2*mu*r^2 - 2*p1*R1^2*R2^2*mu^2 + q1*R1^2*R2^2*mu + 2*p1*R1^2*mu^2*r^2 - q1*R1^2*mu*r^2 - 6*p1*R2^4*mu^2 - q1*R2^4*mu + 6*p1*R2^2*mu^2*r^2 + q1*R2^2*mu*r^2))/(2*K*mu*r^2*(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2));
 

        ur(i) =(K*R2^2*p - mu2*p*r^2 + R2^2*mu2*p)/(2*K*mu2*r) + (exp(-(t*(3*K*R2^2*eta*mu^2 - 3*K*R1^2*eta*mu^2 + R1^2*eta*mu^2*mu2 + 3*R2^2*eta*mu^2*mu2 + 6*K*R1^2*eta*mu*mu2))/(2*R2^2*eta^2*mu^2 - 2*R1^2*eta^2*mu^2 - 6*K*R1^2*eta^2*mu + 6*K*R2^2*eta^2*mu + 6*K*R1^2*eta^2*mu2 + 2*R1^2*eta^2*mu*mu2 + 6*R2^2*eta^2*mu*mu2))*(cosh((mu^2*t*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2))/(eta*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2))) + (eta*sinh((mu^2*t*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2))/(eta*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2)))*((3*eta*p*K^2*R1^2*R2^2*mu^2 - 3*eta*p*K^2*R2^4*mu^2 + 3*eta*p*K*R1^2*R2^2*mu^2*mu2 - 6*eta*p*K*R2^4*mu^2*mu2 + 3*eta*p*K*R2^2*mu^2*mu2*r^2 - eta*p*R1^2*R2^2*mu^2*mu2^2 + eta*p*R1^2*mu^2*mu2^2*r^2 - 3*eta*p*R2^4*mu^2*mu2^2 + 3*eta*p*R2^2*mu^2*mu2^2*r^2)/(3*p*K^2*R1^2*R2^2*eta^2*mu - 3*p*K^2*R2^4*eta^2*mu + p*K*R1^2*R2^2*eta^2*mu^2 + 3*p*K*R1^2*R2^2*eta^2*mu*mu2 - p*K*R2^4*eta^2*mu^2 - 6*p*K*R2^4*eta^2*mu*mu2 + 3*p*K*R2^2*eta^2*mu*mu2*r^2 + p*R1^2*R2^2*eta^2*mu^2*mu2 - p*R1^2*R2^2*eta^2*mu*mu2^2 - p*R1^2*eta^2*mu^2*mu2*r^2 + p*R1^2*eta^2*mu*mu2^2*r^2 - p*R2^4*eta^2*mu^2*mu2 - 3*p*R2^4*eta^2*mu*mu2^2 + p*R2^2*eta^2*mu^2*mu2*r^2 + 3*p*R2^2*eta^2*mu*mu2^2*r^2) - (3*K*R2^2*eta*mu^2 - 3*K*R1^2*eta*mu^2 + R1^2*eta*mu^2*mu2 + 3*R2^2*eta*mu^2*mu2 + 6*K*R1^2*eta*mu*mu2)/(2*R2^2*eta^2*mu^2 - 2*R1^2*eta^2*mu^2 - 6*K*R1^2*eta^2*mu + 6*K*R2^2*eta^2*mu + 6*K*R1^2*eta^2*mu2 + 2*R1^2*eta^2*mu*mu2 + 6*R2^2*eta^2*mu*mu2))*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2))/(mu^2*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2)))*(3*p*K^2*R1^2*R2^2*eta^2*mu - 3*p*K^2*R2^4*eta^2*mu + p*K*R1^2*R2^2*eta^2*mu^2 + 3*p*K*R1^2*R2^2*eta^2*mu*mu2 - p*K*R2^4*eta^2*mu^2 - 6*p*K*R2^4*eta^2*mu*mu2 + 3*p*K*R2^2*eta^2*mu*mu2*r^2 + p*R1^2*R2^2*eta^2*mu^2*mu2 - p*R1^2*R2^2*eta^2*mu*mu2^2 - p*R1^2*eta^2*mu^2*mu2*r^2 + p*R1^2*eta^2*mu*mu2^2*r^2 - p*R2^4*eta^2*mu^2*mu2 - 3*p*R2^4*eta^2*mu*mu2^2 + p*R2^2*eta^2*mu^2*mu2*r^2 + 3*p*R2^2*eta^2*mu*mu2^2*r^2))/(2*K*mu2*r*(R2^2*eta^2*mu^2 - R1^2*eta^2*mu^2 - 3*K*R1^2*eta^2*mu + 3*K*R2^2*eta^2*mu + 3*K*R1^2*eta^2*mu2 + R1^2*eta^2*mu*mu2 + 3*R2^2*eta^2*mu*mu2));
        Srr(i) =- p - (exp(-(t*(3*K*R2^2*eta*mu^2 - 3*K*R1^2*eta*mu^2 + R1^2*eta*mu^2*mu2 + 3*R2^2*eta*mu^2*mu2 + 6*K*R1^2*eta*mu*mu2))/(2*R2^2*eta^2*mu^2 - 2*R1^2*eta^2*mu^2 - 6*K*R1^2*eta^2*mu + 6*K*R2^2*eta^2*mu + 6*K*R1^2*eta^2*mu2 + 2*R1^2*eta^2*mu*mu2 + 6*R2^2*eta^2*mu*mu2))*(cosh((mu^2*t*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2))/(eta*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2))) + (eta*sinh((mu^2*t*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2))/(eta*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2)))*((3*K*R1^2*R2^2*eta*mu^2*p - 3*K*R2^2*eta*mu^2*p*r^2 + 3*R1^2*R2^2*eta*mu^2*mu2*p - 3*R2^2*eta*mu^2*mu2*p*r^2)/(R1^2*R2^2*eta^2*mu^2*p - R2^2*eta^2*mu^2*p*r^2 + 3*K*R1^2*R2^2*eta^2*mu*p - 3*K*R2^2*eta^2*mu*p*r^2 + 3*R1^2*R2^2*eta^2*mu*mu2*p - 3*R2^2*eta^2*mu*mu2*p*r^2) - (3*K*R2^2*eta*mu^2 - 3*K*R1^2*eta*mu^2 + R1^2*eta*mu^2*mu2 + 3*R2^2*eta*mu^2*mu2 + 6*K*R1^2*eta*mu*mu2)/(2*R2^2*eta^2*mu^2 - 2*R1^2*eta^2*mu^2 - 6*K*R1^2*eta^2*mu + 6*K*R2^2*eta^2*mu + 6*K*R1^2*eta^2*mu2 + 2*R1^2*eta^2*mu*mu2 + 6*R2^2*eta^2*mu*mu2))*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2))/(mu^2*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2)))*(R1^2*R2^2*eta^2*mu^2*p - R2^2*eta^2*mu^2*p*r^2 + 3*K*R1^2*R2^2*eta^2*mu*p - 3*K*R2^2*eta^2*mu*p*r^2 + 3*R1^2*R2^2*eta^2*mu*mu2*p - 3*R2^2*eta^2*mu*mu2*p*r^2))/(r^2*(R2^2*eta^2*mu^2 - R1^2*eta^2*mu^2 - 3*K*R1^2*eta^2*mu + 3*K*R2^2*eta^2*mu + 3*K*R1^2*eta^2*mu2 + R1^2*eta^2*mu*mu2 + 3*R2^2*eta^2*mu*mu2));
        Stt(i) =(exp(-(t*(3*K*R2^2*eta*mu^2 - 3*K*R1^2*eta*mu^2 + R1^2*eta*mu^2*mu2 + 3*R2^2*eta*mu^2*mu2 + 6*K*R1^2*eta*mu*mu2))/(2*R2^2*eta^2*mu^2 - 2*R1^2*eta^2*mu^2 - 6*K*R1^2*eta^2*mu + 6*K*R2^2*eta^2*mu + 6*K*R1^2*eta^2*mu2 + 2*R1^2*eta^2*mu*mu2 + 6*R2^2*eta^2*mu*mu2))*(cosh((mu^2*t*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2))/(eta*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2))) + (eta*sinh((mu^2*t*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2))/(eta*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2)))*((3*K*R1^2*R2^2*eta*mu^2*p + 3*K*R2^2*eta*mu^2*p*r^2 + 3*R1^2*R2^2*eta*mu^2*mu2*p + 3*R2^2*eta*mu^2*mu2*p*r^2)/(R1^2*R2^2*eta^2*mu^2*p + R2^2*eta^2*mu^2*p*r^2 + 3*K*R1^2*R2^2*eta^2*mu*p + 3*K*R2^2*eta^2*mu*p*r^2 + 3*R1^2*R2^2*eta^2*mu*mu2*p + 3*R2^2*eta^2*mu*mu2*p*r^2) - (3*K*R2^2*eta*mu^2 - 3*K*R1^2*eta*mu^2 + R1^2*eta*mu^2*mu2 + 3*R2^2*eta*mu^2*mu2 + 6*K*R1^2*eta*mu*mu2)/(2*R2^2*eta^2*mu^2 - 2*R1^2*eta^2*mu^2 - 6*K*R1^2*eta^2*mu + 6*K*R2^2*eta^2*mu + 6*K*R1^2*eta^2*mu2 + 2*R1^2*eta^2*mu*mu2 + 6*R2^2*eta^2*mu*mu2))*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2))/(mu^2*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2)))*(R1^2*R2^2*eta^2*mu^2*p + R2^2*eta^2*mu^2*p*r^2 + 3*K*R1^2*R2^2*eta^2*mu*p + 3*K*R2^2*eta^2*mu*p*r^2 + 3*R1^2*R2^2*eta^2*mu*mu2*p + 3*R2^2*eta^2*mu*mu2*p*r^2))/(r^2*(R2^2*eta^2*mu^2 - R1^2*eta^2*mu^2 - 3*K*R1^2*eta^2*mu + 3*K*R2^2*eta^2*mu + 3*K*R1^2*eta^2*mu2 + R1^2*eta^2*mu*mu2 + 3*R2^2*eta^2*mu*mu2)) - p;
 

    else

        %C:\Users\eart0546\Documents\GitHub\MAST_strain_compuations\ViscoelasticDerivation2D_Try4.m
        %2nd part "%% Using viscoelastic book derivation Eq.8.40a-c"
        %UseEsub==1
        ur(i) =(R2^2*p)/(2*mu*r) + (R2^2*p*q1*exp(-(t*(3*K*R2^2*q1 - 3*K*R1^2*q1 + R1^2*mu*q1 + 3*R2^2*mu*q1 + 12*K*R1^2*mu*p1))/(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2))*(R1^2 - R2^2)*(cosh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1))) + (sinh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1)))*(- 18*p1*K^2*R1^2 + 18*p1*K^2*R2^2 - 24*p1*K*R1^2*mu - 3*q1*K*R1^2 + 36*p1*K*R2^2*mu + 3*q1*K*R2^2 + 6*p1*R1^2*mu^2 - 7*q1*R1^2*mu + 18*p1*R2^2*mu^2 + 3*q1*R2^2*mu))/((q1 + 6*K*p1 + 6*mu*p1)*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2)))*(q1 + 6*K*p1 + 6*mu*p1))/(2*mu*r*(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2));
        Srr(i) =- (R2^2*p)/r^2 - (R2^2*p*q1*exp(-(t*(3*K*R2^2*q1 - 3*K*R1^2*q1 + R1^2*mu*q1 + 3*R2^2*mu*q1 + 12*K*R1^2*mu*p1))/(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2))*(R1^2 - R2^2)*(cosh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1))) + (sinh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1)))*(- 18*p1*K^2*R1^2 + 18*p1*K^2*R2^2 - 24*p1*K*R1^2*mu - 3*q1*K*R1^2 + 36*p1*K*R2^2*mu + 3*q1*K*R2^2 + 6*p1*R1^2*mu^2 - 7*q1*R1^2*mu + 18*p1*R2^2*mu^2 + 3*q1*R2^2*mu))/((q1 + 6*K*p1 + 6*mu*p1)*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2)))*(q1 + 6*K*p1 + 6*mu*p1))/(r^2*(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2));
        Stt(i) =(R2^2*p)/r^2 + (R2^2*p*q1*exp(-(t*(3*K*R2^2*q1 - 3*K*R1^2*q1 + R1^2*mu*q1 + 3*R2^2*mu*q1 + 12*K*R1^2*mu*p1))/(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2))*(R1^2 - R2^2)*(cosh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1))) + (sinh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1)))*(- 18*p1*K^2*R1^2 + 18*p1*K^2*R2^2 - 24*p1*K*R1^2*mu - 3*q1*K*R1^2 + 36*p1*K*R2^2*mu + 3*q1*K*R2^2 + 6*p1*R1^2*mu^2 - 7*q1*R1^2*mu + 18*p1*R2^2*mu^2 + 3*q1*R2^2*mu))/((q1 + 6*K*p1 + 6*mu*p1)*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2)))*(q1 + 6*K*p1 + 6*mu*p1))/(r^2*(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2));

        Err(i) =- (R2^2*p)/(2*mu*r^2) - (R2^2*p*q1*exp(-(t*(3*K*R2^2*q1 - 3*K*R1^2*q1 + R1^2*mu*q1 + 3*R2^2*mu*q1 + 12*K*R1^2*mu*p1))/(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2))*(R1^2 - R2^2)*(cosh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1))) + (sinh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1)))*(- 18*p1*K^2*R1^2 + 18*p1*K^2*R2^2 - 24*p1*K*R1^2*mu - 3*q1*K*R1^2 + 36*p1*K*R2^2*mu + 3*q1*K*R2^2 + 6*p1*R1^2*mu^2 - 7*q1*R1^2*mu + 18*p1*R2^2*mu^2 + 3*q1*R2^2*mu))/((q1 + 6*K*p1 + 6*mu*p1)*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2)))*(q1 + 6*K*p1 + 6*mu*p1))/(2*mu*r^2*(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2));
        Ett(i) =(R2^2*p)/(2*mu*r^2) + (R2^2*p*q1*exp(-(t*(3*K*R2^2*q1 - 3*K*R1^2*q1 + R1^2*mu*q1 + 3*R2^2*mu*q1 + 12*K*R1^2*mu*p1))/(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2))*(R1^2 - R2^2)*(cosh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1))) + (sinh((q1*t*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2))/(2*mu*p1*(R1^2*q1 + 3*R2^2*q1 + 6*K*R1^2*p1) - R1^2*q1*(q1 + 6*K*p1) + R2^2*q1*(q1 + 6*K*p1)))*(- 18*p1*K^2*R1^2 + 18*p1*K^2*R2^2 - 24*p1*K*R1^2*mu - 3*q1*K*R1^2 + 36*p1*K*R2^2*mu + 3*q1*K*R2^2 + 6*p1*R1^2*mu^2 - 7*q1*R1^2*mu + 18*p1*R2^2*mu^2 + 3*q1*R2^2*mu))/((q1 + 6*K*p1 + 6*mu*p1)*(9*K^2*R1^4 - 18*K^2*R1^2*R2^2 + 9*K^2*R2^4 + 6*K*R1^4*mu - 24*K*R1^2*R2^2*mu + 18*K*R2^4*mu + R1^4*mu^2 + 6*R1^2*R2^2*mu^2 + 9*R2^4*mu^2)^(1/2)))*(q1 + 6*K*p1 + 6*mu*p1))/(2*mu*r^2*(R2^2*q1^2 - R1^2*q1^2 - 6*K*R1^2*p1*q1 + 6*K*R2^2*p1*q1 + 2*R1^2*mu*p1*q1 + 6*R2^2*mu*p1*q1 + 12*K*R1^2*mu*p1^2));
        
        % %Airy funcs

        ur(i) =(R2^2*p)/(2*mu*r) - (exp(-(t*(3*K*R2^2*eta*mu^2 - 3*K*R1^2*eta*mu^2 + R1^2*eta*mu^2*mu2 + 3*R2^2*eta*mu^2*mu2 + 6*K*R1^2*eta*mu*mu2))/(2*R2^2*eta^2*mu^2 - 2*R1^2*eta^2*mu^2 - 6*K*R1^2*eta^2*mu + 6*K*R2^2*eta^2*mu + 6*K*R1^2*eta^2*mu2 + 2*R1^2*eta^2*mu*mu2 + 6*R2^2*eta^2*mu*mu2))*(cosh((mu^2*t*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2))/(eta*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2))) + (eta*sinh((mu^2*t*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2))/(eta*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2)))*((3*K*R2^4*eta*mu*p + 3*R2^4*eta*mu*mu2*p - 3*K*R1^2*R2^2*eta*mu*p - 3*R1^2*R2^2*eta*mu*mu2*p)/(3*K*R2^4*eta^2*p + R2^4*eta^2*mu*p + 3*R2^4*eta^2*mu2*p - 3*K*R1^2*R2^2*eta^2*p - R1^2*R2^2*eta^2*mu*p - 3*R1^2*R2^2*eta^2*mu2*p) - (3*K*R2^2*eta*mu^2 - 3*K*R1^2*eta*mu^2 + R1^2*eta*mu^2*mu2 + 3*R2^2*eta*mu^2*mu2 + 6*K*R1^2*eta*mu*mu2)/(2*R2^2*eta^2*mu^2 - 2*R1^2*eta^2*mu^2 - 6*K*R1^2*eta^2*mu + 6*K*R2^2*eta^2*mu + 6*K*R1^2*eta^2*mu2 + 2*R1^2*eta^2*mu*mu2 + 6*R2^2*eta^2*mu*mu2))*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2))/(mu^2*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2)))*(3*K*R2^4*eta^2*p + R2^4*eta^2*mu*p + 3*R2^4*eta^2*mu2*p - 3*K*R1^2*R2^2*eta^2*p - R1^2*R2^2*eta^2*mu*p - 3*R1^2*R2^2*eta^2*mu2*p))/(2*r*(R2^2*eta^2*mu^2 - R1^2*eta^2*mu^2 - 3*K*R1^2*eta^2*mu + 3*K*R2^2*eta^2*mu + 3*K*R1^2*eta^2*mu2 + R1^2*eta^2*mu*mu2 + 3*R2^2*eta^2*mu*mu2));
        Srr(i) =(exp(-(t*(3*K*R2^2*eta*mu^2 - 3*K*R1^2*eta*mu^2 + R1^2*eta*mu^2*mu2 + 3*R2^2*eta*mu^2*mu2 + 6*K*R1^2*eta*mu*mu2))/(2*R2^2*eta^2*mu^2 - 2*R1^2*eta^2*mu^2 - 6*K*R1^2*eta^2*mu + 6*K*R2^2*eta^2*mu + 6*K*R1^2*eta^2*mu2 + 2*R1^2*eta^2*mu*mu2 + 6*R2^2*eta^2*mu*mu2))*(cosh((mu^2*t*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2))/(eta*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2))) + (eta*sinh((mu^2*t*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2))/(eta*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2)))*((3*R2^4*eta*mu^2*mu2*p + 3*K*R2^4*eta*mu^2*p - 3*K*R1^2*R2^2*eta*mu^2*p - 3*R1^2*R2^2*eta*mu^2*mu2*p)/(R2^4*eta^2*mu^2*p + 3*R2^4*eta^2*mu*mu2*p - R1^2*R2^2*eta^2*mu^2*p + 3*K*R2^4*eta^2*mu*p - 3*K*R1^2*R2^2*eta^2*mu*p - 3*R1^2*R2^2*eta^2*mu*mu2*p) - (3*K*R2^2*eta*mu^2 - 3*K*R1^2*eta*mu^2 + R1^2*eta*mu^2*mu2 + 3*R2^2*eta*mu^2*mu2 + 6*K*R1^2*eta*mu*mu2)/(2*R2^2*eta^2*mu^2 - 2*R1^2*eta^2*mu^2 - 6*K*R1^2*eta^2*mu + 6*K*R2^2*eta^2*mu + 6*K*R1^2*eta^2*mu2 + 2*R1^2*eta^2*mu*mu2 + 6*R2^2*eta^2*mu*mu2))*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2))/(mu^2*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2)))*(R2^4*eta^2*mu^2*p + 3*R2^4*eta^2*mu*mu2*p - R1^2*R2^2*eta^2*mu^2*p + 3*K*R2^4*eta^2*mu*p - 3*K*R1^2*R2^2*eta^2*mu*p - 3*R1^2*R2^2*eta^2*mu*mu2*p))/(r^2*(R2^2*eta^2*mu^2 - R1^2*eta^2*mu^2 - 3*K*R1^2*eta^2*mu + 3*K*R2^2*eta^2*mu + 3*K*R1^2*eta^2*mu2 + R1^2*eta^2*mu*mu2 + 3*R2^2*eta^2*mu*mu2)) - (R2^2*p)/r^2;
        Stt(i) =(R2^2*p)/r^2 - (exp(-(t*(3*K*R2^2*eta*mu^2 - 3*K*R1^2*eta*mu^2 + R1^2*eta*mu^2*mu2 + 3*R2^2*eta*mu^2*mu2 + 6*K*R1^2*eta*mu*mu2))/(2*R2^2*eta^2*mu^2 - 2*R1^2*eta^2*mu^2 - 6*K*R1^2*eta^2*mu + 6*K*R2^2*eta^2*mu + 6*K*R1^2*eta^2*mu2 + 2*R1^2*eta^2*mu*mu2 + 6*R2^2*eta^2*mu*mu2))*(cosh((mu^2*t*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2))/(eta*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2))) + (eta*sinh((mu^2*t*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2))/(eta*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2)))*((3*R2^4*eta*mu^2*mu2*p + 3*K*R2^4*eta*mu^2*p - 3*K*R1^2*R2^2*eta*mu^2*p - 3*R1^2*R2^2*eta*mu^2*mu2*p)/(R2^4*eta^2*mu^2*p + 3*R2^4*eta^2*mu*mu2*p - R1^2*R2^2*eta^2*mu^2*p + 3*K*R2^4*eta^2*mu*p - 3*K*R1^2*R2^2*eta^2*mu*p - 3*R1^2*R2^2*eta^2*mu*mu2*p) - (3*K*R2^2*eta*mu^2 - 3*K*R1^2*eta*mu^2 + R1^2*eta*mu^2*mu2 + 3*R2^2*eta*mu^2*mu2 + 6*K*R1^2*eta*mu*mu2)/(2*R2^2*eta^2*mu^2 - 2*R1^2*eta^2*mu^2 - 6*K*R1^2*eta^2*mu + 6*K*R2^2*eta^2*mu + 6*K*R1^2*eta^2*mu2 + 2*R1^2*eta^2*mu*mu2 + 6*R2^2*eta^2*mu*mu2))*(R2^2*mu^2 - R1^2*mu^2 - 3*K*R1^2*mu + 3*K*R2^2*mu + 3*K*R1^2*mu2 + R1^2*mu*mu2 + 3*R2^2*mu*mu2))/(mu^2*((9*K^2*R1^4)/4 - (9*K^2*R1^2*R2^2)/2 + (9*K^2*R2^4)/4 + (3*K*R1^4*mu2)/2 - 6*K*R1^2*R2^2*mu2 + (9*K*R2^4*mu2)/2 + (R1^4*mu2^2)/4 + (3*R1^2*R2^2*mu2^2)/2 + (9*R2^4*mu2^2)/4)^(1/2)))*(R2^4*eta^2*mu^2*p + 3*R2^4*eta^2*mu*mu2*p - R1^2*R2^2*eta^2*mu^2*p + 3*K*R2^4*eta^2*mu*p - 3*K*R1^2*R2^2*eta^2*mu*p - 3*R1^2*R2^2*eta^2*mu*mu2*p))/(r^2*(R2^2*eta^2*mu^2 - R1^2*eta^2*mu^2 - 3*K*R1^2*eta^2*mu + 3*K*R2^2*eta^2*mu + 3*K*R1^2*eta^2*mu2 + R1^2*eta^2*mu*mu2 + 3*R2^2*eta^2*mu*mu2));
 
 


    end

        %Err(i) =0; %NEED TO DO 
        Szz(i)=nu*(Srr(i)+Stt(i));%Pollard 8.35
        %Ett(i)=0; %NEED TO DO 
        Ezz(i)=0; %Plane strain    
end
%In the fluid
ur(rIn<R1)=nan;
Srr(rIn<R1)=-p;
Stt(rIn<R1)=-p;
Err(rIn<R1) =nan;% 1./E.*(Srr(rIn<R1).*(1-nu.^2)-(Stt(rIn<R1).*nu.*(1+nu)));
Ett(rIn<R1) =nan;% 1./E.*(Stt(rIn<R1).*(1-nu.^2)-(Srr(rIn<R1).*nu.*(1+nu)));

end